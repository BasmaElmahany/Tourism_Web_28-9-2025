<div class="attractions-container" [class.rtl]="i18n.isRTL()" [class.ltr]="!i18n.isRTL()">
  <!-- Page Header -->
  <section class="page-header">
    <div class="header-background">
      <img src="/assets/images/hero_banner.png" alt="Minya Attractions" class="header-image" />
      <div class="header-overlay"></div>
    </div>
    <div class="header-content">
      <div class="container">
        <h1 class="page-title fade-in">
          {{ i18n.translate('attractionsTitle') }}
        </h1>
        <p class="page-subtitle fade-in">
          {{ i18n.translate('attractionsSubtitle') }}
        </p>
      </div>
    </div>
  </section>

  <!-- Filters and Search -->
  <section class="filters-section">
    <div class="container">
      <div class="filters-header">
        <div class="search-container">
          <div class="search-input-wrapper">
            <span class="material-icons search-icon">search</span>
            <input type="text" class="search-input" [placeholder]="i18n.translate('searchAttractions')"
              [(ngModel)]="searchQuery" (input)="onSearch()" />
          </div>
        </div>

        <div class="view-controls">
          <div class="filter-dropdown">
            <select [(ngModel)]="selectedCategory" (change)="onFilterChange()" class="filter-select">
              <option value="">{{ i18n.translate('allCategories') }}</option>

              <!-- Values equal the localized strings used inside the data to ensure filtering works in both languages -->
              <option [ngValue]="catHistoricalSite">{{ i18n.translate('historicalSites') }}</option>
              <option [ngValue]="catArchaeologicalSite">{{ i18n.translate('archaeologicalSites') }}</option>
              <option [ngValue]="museum">{{ i18n.translate('Museum') }}</option>
              <option [ngValue]="catReligiouIsamicSite">{{ i18n.translate('Islamic_Religious_Site') }}</option>
              <option [ngValue]="catReligiouChristianSite">{{ i18n.translate('Christian_religious_site') }}</option>
              <option [ngValue]="catScenicArea">{{ i18n.translate('scenicAreas') }}</option>
            </select>
          </div>

          <div class="view-toggle">
            <button class="view-btn" [class.active]="viewMode === 'grid'" (click)="setViewMode('grid')"
              [title]="i18n.isRTL() ? 'شبكة' : 'Grid View'">
              <span class="material-icons">grid_view</span>
            </button>
            <button class="view-btn" [class.active]="viewMode === 'list'" (click)="setViewMode('list')"
              [title]="i18n.isRTL() ? 'قائمة' : 'List View'">
              <span class="material-icons">view_list</span>
            </button>
          </div>
        </div>
      </div>

      <div class="results-info" *ngIf="filteredAttractions.length > 0">
        <p>
          {{ i18n.formatNumber(filteredAttractions.length) }} / {{ i18n.formatNumber(totalAttractions) }}
          {{ i18n.translate('attractions') }}
        </p>
      </div>
    </div>
  </section>

  <!-- Attractions Grid/List -->
  <section class="attractions-section">
    <div class="container">
      <div class="loading-container" *ngIf="loading">
        <div class="spinner"></div>
        <p>{{ i18n.translate('loading') }}</p>
      </div>

      <div class="no-results" *ngIf="!loading && filteredAttractions.length === 0">
        <div class="no-results-icon">
          <span class="material-icons">search_off</span>
        </div>
        <h3>{{ i18n.translate('noResults') }}</h3>
        <p>{{ i18n.translate('exploreAttractions') }}</p>
        <button class="btn btn-primary" (click)="clearFilters()">
          <span class="material-icons">clear</span>
          {{ i18n.translate('clearFilters') }}
        </button>
      </div>

      <!-- Grid View -->
      <div class="attractions-grid" *ngIf="!loading && filteredAttractions.length > 0 && viewMode === 'grid'">
        <div class="attraction-card" *ngFor="let attraction of filteredAttractions; trackBy: trackByAttractionId">
          <div class="card-image">
            <img [src]="attraction.imageUrl" [alt]="i18n.pick(attraction.name )" loading="lazy" />
            <div class="card-overlay">
              <div class="rating">
                <span class="material-icons">star</span>
                <span>{{ i18n.formatNumber(attraction.rating) }}</span>
                <span class="review-count">({{ i18n.formatNumber(attraction.reviewCount) }})</span>
              </div>
              <div class="category-badge">
                {{ i18n.pick((attraction ).category) }}
              </div>
            </div>
          </div>

          <div class="card-content">
            <h3 class="attraction-name">{{ i18n.pick(attraction.name ) }}</h3>
            <p class="attraction-description">
              {{ i18n.pick(attraction.description ) | slice:0:120 }}...
            </p>

            <div class="attraction-details">
              <div class="detail-item">
                <span class="material-icons">schedule</span>
                <span>{{ i18n.pick((attraction ).openingHours) }}</span>
              </div>
              <div class="detail-item">
                <span class="material-icons">local_offer</span>
                <span>{{ i18n.pick((attraction ).ticketPrice) }}</span>
              </div>
            </div>

            <div class="card-actions">
              <a [routerLink]="['/attractions', attraction.id]" class="btn btn-primary">
                <span class="material-icons">visibility</span>
                {{ i18n.translate('viewDetails') }}
              </a>
              <button class="btn-favorite" [class.active]="isFavorite(attraction.id)"
                (click)="toggleFavorite(attraction, $event)"
                [attr.aria-label]="isFavorite(attraction.id) ? (i18n.translate('removeFromFavorites') || 'Remove from favorites') : (i18n.translate('addToFavorites') || 'Add to favorites')">
                <span class="material-icons">{{ isFavorite(attraction.id) ? 'favorite' : 'favorite_border' }}</span>
              </button>

            </div>
          </div>
        </div>
      </div>

      <!-- List View -->
      <div class="attractions-list" *ngIf="!loading && filteredAttractions.length > 0 && viewMode === 'list'">
        <div class="attraction-list-item" *ngFor="let attraction of filteredAttractions; trackBy: trackByAttractionId">
          <div class="list-item-image">
            <img [src]="attraction.imageUrl" [alt]="i18n.pick(attraction.name )" loading="lazy" />
          </div>

          <div class="list-item-content">
            <div class="list-item-header">
              <h3 class="attraction-name">{{ i18n.pick(attraction.name ) }}</h3>
              <div class="rating">
                <span class="material-icons">star</span>
                <span>{{ i18n.formatNumber(attraction.rating) }}</span>
                <span class="review-count">({{ i18n.formatNumber(attraction.reviewCount) }})</span>
              </div>
            </div>

            <p class="attraction-description">
              {{ i18n.pick(attraction.description) | slice:0:150 }}...
            </p>
            <div class="list-item-details">
              <div class="detail-group">
                <div class="detail-item">
                  <span class="material-icons">category</span>
                  <span>{{ i18n.pick((attraction).category) }}</span>
                </div>
                <div class="detail-item">
                  <span class="material-icons">schedule</span>
                  <span>{{ i18n.pick((attraction ).openingHours) }}</span>
                </div>
                <div class="detail-item">
                  <span class="material-icons">local_offer</span>
                  <span>{{ i18n.pick((attraction ).ticketPrice) }}</span>
                </div>
              </div>

              <ng-container *ngIf="attraction?.features as feats">
                <div class="features-list" *ngIf="feats.length > 0">
                  <span class="feature-tag" *ngFor="let feature of i18n.pickArray(feats).slice(0, 3)">
                    {{ feature }}
                  </span>
                </div>
              </ng-container>
            </div>

            <div class="list-item-actions">
              <a [routerLink]="['/attractions', attraction.id]" class="btn btn-primary">
                <span class="material-icons">visibility</span>
                {{ i18n.translate('viewDetails') }}
              </a>
              <button class="btn-favorite" [class.active]="isFavorite(attraction.id)"
                (click)="toggleFavorite(attraction, $event)"
                [attr.aria-label]="isFavorite(attraction.id) ? (i18n.translate('removeFromFavorites') || 'Remove from favorites') : (i18n.translate('addToFavorites') || 'Add to favorites')">
                <span class="material-icons">{{ isFavorite(attraction.id) ? 'favorite' : 'favorite_border' }}</span>
              </button>

            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Featured Section -->
  <section class="featured-section" *ngIf="!loading && filteredAttractions.length > 0">
    <div class="container">
      <h2 class="section-title">{{ i18n.translate('whyVisitMinya') }}</h2>

      <div class="features-grid">
        <div class="feature-item">
          <div class="feature-icon">
            <span class="material-icons">history_edu</span>
          </div>
          <h3>{{ i18n.translate('richHistory') }}</h3>
          <p>{{ i18n.translate('richHistoryDesc') }}</p>
        </div>

        <div class="feature-item">
          <div class="feature-icon">
            <span class="material-icons">landscape</span>
          </div>
          <h3>{{ i18n.translate('scenicBeauty') }}</h3>
          <p>{{ i18n.translate('scenicBeautyDesc') }}</p>
        </div>

        <div class="feature-item">
          <div class="feature-icon">
            <span class="material-icons">groups</span>
          </div>
          <h3>{{ i18n.translate('culturalHeritage') }}</h3>
          <p>{{ i18n.translate('culturalHeritageDesc') }}</p>
        </div>
      </div>
    </div>
  </section>
</div>